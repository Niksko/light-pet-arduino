worker_processes auto;
worker_cpu_affinity auto;
pcre_jit on;
# error_log /var/log/nginx/error.log debug;

events {
    worker_connections 2048;
}


http {
    ssl_ciphers "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH:AES128-SHA:AES256-SHA:AES128-SHA256:AES256-SHA256";
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;
    add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload";
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    ssl_session_tickets off;
    resolver 10.0.0.1 valid=300s; # Local dns server
    resolver_timeout 5s;

    # Redirect to HTTPS
    server {
        listen 80;
        server_name 10.0.0.30;
        return 301 https://$host$request_uri;
    }

    server {
        #listen 80; # Uncomment to also listen for HTTP requests
        listen 443 ssl; # HTTP/2 is only possible when using SSL

        server_name 10.0.0.30;
        ssl_certificate ssl/10.0.0.30.crt;
        ssl_certificate_key ssl/10.0.0.30.key;


        location / {
            return 200;
        }
    }
}
